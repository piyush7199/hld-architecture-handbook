# 2.1.16 Object Storage Deep Dive: Scalable File Storage for the Cloud

## Intuitive Explanation

Imagine you need to store millions of files (photos, videos, documents) for a web application. Traditional file
systems (like your computer's hard drive) aren't designed for this scale â€” they break down with millions of files, can't
handle concurrent access from thousands of users, and don't scale across multiple servers.

**Object Storage** is like a massive, infinitely scalable filing cabinet in the cloud. Instead of organizing files in
folders (hierarchical), you store files as "objects" with unique IDs. You can store billions of objects, access them
from anywhere, and they're automatically replicated for durability.

**Key Characteristics:**

- **Flat Namespace:** No folders (just unique object keys/IDs)
- **RESTful API:** Access via HTTP/HTTPS (like a website)
- **Unlimited Scale:** Store petabytes of data, billions of objects
- **Durability:** 99.999999999% (11 9s) â€” virtually impossible to lose data

---

## In-Depth Analysis

### 1. What is Object Storage?

**Object Storage** is a storage architecture that manages data as objects (files + metadata) rather than as files in a
file system hierarchy or as blocks in a block storage system.

**Key Components:**

- **Object:** The file itself + metadata (name, size, content-type, custom metadata)
- **Bucket/Container:** A namespace for organizing objects (like a top-level folder)
- **Key/Path:** Unique identifier for the object (e.g., `images/photo.jpg`)

**Architecture:**

```
Bucket: my-app-storage
  â”œâ”€ images/
  â”‚   â”œâ”€ photo1.jpg (object key: images/photo1.jpg)
  â”‚   â””â”€ photo2.jpg (object key: images/photo2.jpg)
  â”œâ”€ videos/
  â”‚   â””â”€ movie.mp4 (object key: videos/movie.mp4)
  â””â”€ documents/
      â””â”€ report.pdf (object key: documents/report.pdf)
```

### 2. Object Storage vs. Traditional Storage

| Aspect        | File System                    | Block Storage        | Object Storage                  |
|---------------|--------------------------------|----------------------|---------------------------------|
| **Structure** | Hierarchical (folders/files)   | Blocks (raw storage) | Flat (buckets/objects)          |
| **Access**    | File system APIs               | Block device APIs    | REST API (HTTP)                 |
| **Scale**     | Limited (millions of files)    | Limited (TB range)   | Unlimited (billions of objects) |
| **Metadata**  | Limited (filename, size, date) | None                 | Rich (custom metadata)          |
| **Use Case**  | Local files, applications      | Databases, VMs       | Web apps, backups, archives     |

### 3. Key Features

#### A. RESTful API

**Access via HTTP:**

```
GET https://bucket.s3.amazonaws.com/images/photo.jpg
PUT https://bucket.s3.amazonaws.com/images/photo.jpg
DELETE https://bucket.s3.amazonaws.com/images/photo.jpg
```

**Benefits:**

- Works from any language/platform
- Can be accessed from browsers
- Standard HTTP authentication/authorization

#### B. Metadata

**System Metadata:**

- Content-Type (image/jpeg, video/mp4)
- Content-Length (file size)
- Last-Modified (timestamp)
- ETag (checksum for integrity)

**Custom Metadata:**

```
x-amz-meta-author: John Doe
x-amz-meta-category: photos
x-amz-meta-uploaded-by: user123
```

#### C. Versioning

**How It Works:**

- Store multiple versions of same object
- Each version has unique version ID
- Can restore previous versions

**Use Case:**

- Accidentally overwrite file â†’ Restore previous version
- Track file history
- Compliance (retain all versions)

#### D. Lifecycle Policies

**Automated Transitions:**

```
Rule 1: Move objects older than 30 days to cheaper storage (Glacier)
Rule 2: Delete objects older than 1 year
Rule 3: Move incomplete uploads to cheaper storage after 7 days
```

**Storage Classes:**

- **Standard:** Hot storage (frequent access)
- **Infrequent Access (IA):** Cheaper, less frequent access
- **Glacier:** Archive storage (very cheap, retrieval takes hours)
- **Deep Archive:** Cheapest, retrieval takes 12 hours

### 4. Object Storage Providers

#### AWS S3 (Simple Storage Service)

**Features:**

- 99.999999999% durability (11 9s)
- Unlimited storage
- Multiple storage classes
- Versioning, lifecycle policies
- Event notifications (S3 â†’ Lambda, SNS, SQS)

**Use Cases:**

- Web application storage
- Data lakes
- Backup and archive
- Static website hosting

#### Google Cloud Storage (GCS)

**Features:**

- Similar to S3
- Integrated with GCP services
- Multi-regional buckets
- Object versioning

**Use Cases:**

- GCP-based applications
- Data analytics (BigQuery integration)
- ML model storage

#### Azure Blob Storage

**Features:**

- Similar to S3
- Integrated with Azure services
- Hot, Cool, Archive tiers
- Azure AD integration

**Use Cases:**

- Azure-based applications
- Media storage
- Backup and disaster recovery

### 5. Common Use Cases

#### A. Web Application Assets

**Content:** User-uploaded images, videos, documents

**Architecture:**

```
User uploads image â†’ Application â†’ S3
User views image â†’ CDN â†’ S3 (if cache miss)
```

**Benefits:**

- Scalable (unlimited storage)
- Cost-effective (pay for what you use)
- CDN integration (fast delivery)

#### B. Data Lakes

**Content:** Raw data (logs, events, analytics data)

**Architecture:**

```
Applications â†’ S3 (raw data)
Analytics Tools â†’ S3 (read data)
ETL Pipeline â†’ S3 (processed data)
```

**Benefits:**

- Unlimited scale
- Cost-effective for large datasets
- Supports various data formats

#### C. Backup and Archive

**Content:** Database backups, application backups

**Architecture:**

```
Database â†’ Daily backup â†’ S3 Standard
After 30 days â†’ S3 Glacier (cheaper)
After 1 year â†’ S3 Deep Archive (cheapest)
```

**Benefits:**

- Automated lifecycle policies
- Cost-effective long-term storage
- High durability

#### D. Static Website Hosting

**Content:** HTML, CSS, JavaScript files

**Architecture:**

```
Static files â†’ S3 bucket (website hosting enabled)
DNS â†’ Routes to S3 bucket
CDN â†’ Caches S3 content
```

**Benefits:**

- Simple (no web server needed)
- Scalable (handles any traffic)
- Cost-effective (pay for storage + requests)

### 6. Multipart Upload

**Problem:** Large files (GB+) timeout or fail during upload

**Solution:** Multipart Upload

**How It Works:**

```
1. Initiate multipart upload â†’ Get upload ID
2. Upload file in chunks (5 MB each)
   - Upload Part 1 (bytes 0-5MB)
   - Upload Part 2 (bytes 5-10MB)
   - Upload Part 3 (bytes 10-15MB)
3. Complete multipart upload â†’ Combine parts
4. Result: Single object in S3
```

**Benefits:**

- **Resumable:** Can retry failed parts without re-uploading entire file
- **Parallel:** Upload multiple parts simultaneously (faster)
- **Reliable:** Large files don't timeout

**Example:**

```
File: 1 GB video
Chunks: 200 parts Ã— 5 MB each
Upload: Parallel (10 parts at a time)
Time: 2 minutes (vs 10 minutes single upload)
```

### 7. Access Control

#### A. Bucket Policies

**IAM-Based Access:**

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::my-bucket/*"
    }
  ]
}
```

#### B. Pre-Signed URLs

**Temporary Access:**

```
1. Application generates pre-signed URL (valid for 1 hour)
2. User accesses URL â†’ Downloads file
3. URL expires after 1 hour â†’ No longer accessible
```

**Use Case:**

- Private files (user-specific content)
- Time-limited access
- No authentication required (URL is the key)

#### C. CORS (Cross-Origin Resource Sharing)

**Allow Browser Access:**

```
Bucket CORS configuration:
  - Allow origin: https://example.com
  - Allow methods: GET, PUT
  - Allow headers: Content-Type
```

**Use Case:**

- Direct browser uploads to S3
- Web applications accessing S3 from browser

---

## When to Use Object Storage

### âœ… Use Object Storage When:

1. **Large Files:** Videos, images, backups (GB+ files)
2. **Unlimited Scale:** Need to store billions of objects
3. **Web Access:** Files accessed via HTTP/HTTPS
4. **Static Content:** Images, videos, documents (rarely updated)
5. **Backup/Archive:** Long-term storage with lifecycle policies
6. **Data Lakes:** Raw data storage for analytics

### âŒ Don't Use Object Storage When:

1. **Frequent Updates:** Files updated many times per second (use database)
2. **Structured Data:** Relational data (use database)
3. **Low Latency:** Need <1ms access (use cache or database)
4. **Transactional:** Need ACID guarantees (use database)
5. **File System APIs:** Need POSIX file system (use EFS, NFS)

---

## Real-World Examples

### Netflix

**Use Case:** Video storage and delivery

**Architecture:**

- **S3:** Stores original video files
- **CDN:** Caches and serves videos globally
- **Scale:** Petabytes of video content

### Instagram

**Use Case:** User-uploaded photos

**Architecture:**

- **S3:** Stores original photos
- **Processing:** Resize, optimize photos
- **CDN:** Serves optimized photos globally
- **Scale:** Billions of photos

### Dropbox

**Use Case:** File storage and sync

**Architecture:**

- **S3/GCS:** Stores user files
- **Metadata DB:** Tracks file metadata (PostgreSQL)
- **Sync Service:** Syncs files across devices

---

## Object Storage vs. Other Storage Solutions

| Solution                | Best For                      | Latency  | Scale     | Cost   |
|-------------------------|-------------------------------|----------|-----------|--------|
| **Object Storage (S3)** | Web assets, backups, archives | 50-200ms | Unlimited | Low    |
| **File System (EFS)**   | Shared file storage, POSIX    | <10ms    | TB range  | Medium |
| **Block Storage (EBS)** | Databases, VMs                | <1ms     | TB range  | High   |
| **Database (RDBMS)**    | Structured data, transactions | <10ms    | TB range  | High   |

---

## Common Anti-Patterns

### âŒ **1. Using Object Storage as Database**

**Problem:** Storing structured data (user profiles, orders) in S3

**Why It's Wrong:**

- No query capabilities (can't search, filter)
- High latency (50-200ms vs <10ms database)
- No transactions (can't update multiple objects atomically)

**Solution:** Use database for structured data, S3 for files

### âŒ **2. No Lifecycle Policies**

**Problem:** All data in expensive Standard storage forever

**Solution:** Use lifecycle policies to move old data to cheaper storage

```
âŒ Bad:
All data in Standard storage ($0.023/GB/month)
Cost: 1 PB Ã— $0.023 = $23,000/month

âœ… Good:
Recent data (30 days): Standard ($0.023/GB)
Old data (30+ days): Glacier ($0.004/GB)
Cost: 100 TB Standard + 900 TB Glacier = $2,300 + $3,600 = $5,900/month
Savings: 74% reduction
```

### âŒ **3. No CDN for Public Content**

**Problem:** Serving images/videos directly from S3 to users worldwide

**Why It's Wrong:**

- High latency (users far from S3 region)
- High bandwidth costs ($0.09/GB from S3)
- S3 request limits (5,500 GET/sec per prefix)

**Solution:** Use CDN (CloudFront) in front of S3

```
âŒ Bad:
User â†’ S3 (direct) â†’ 200ms latency, $0.09/GB

âœ… Good:
User â†’ CDN â†’ S3 (if cache miss) â†’ 20ms latency, $0.01/GB
95% cache hit rate â†’ 95% reduction in S3 bandwidth costs
```

---

## Trade-offs Summary

| Aspect              | What You Gain                            | What You Sacrifice                           |
|---------------------|------------------------------------------|----------------------------------------------|
| **Unlimited Scale** | Store petabytes, billions of objects     | Higher latency than file system              |
| **REST API**        | Universal access, simple integration     | No file system semantics (no folders)        |
| **Durability**      | 11 9s (virtually impossible to lose)     | Eventual consistency (updates may take time) |
| **Cost-Effective**  | Pay for what you use, lifecycle policies | Retrieval costs for Glacier (archive)        |
| **Metadata**        | Rich metadata support                    | Limited query capabilities                   |

---

## References

- **AWS S3 Documentation:** [https://docs.aws.amazon.com/s3/](https://docs.aws.amazon.com/s3/)
- **Google Cloud Storage:** [https://cloud.google.com/storage/docs](https://cloud.google.com/storage/docs)
- **Related Chapters:**
    - [2.2.4 CDN Deep Dive](../2.2-caching/2.2.4-cdn-deep-dive.md) - CDN integration with object storage
    - [2.1.4 Database Scaling](../2.1-databases/2.1.4-database-scaling.md) - When to use object storage vs database

---

## âœï¸ Design Challenge

### Problem

You are designing a photo-sharing application (similar to Instagram) that allows users to upload, store, and view
photos. The application must:

1. **Store 10 billion photos** (average 2 MB per photo = 20 PB)
2. **Handle 1 million uploads per day** (peak: 100k uploads/hour)
3. **Serve 10 billion photo views per day** (peak: 1M views/second)
4. **Support multiple photo sizes** (thumbnail, medium, large, original)
5. **Minimize storage and bandwidth costs** (cost is primary concern)

**Constraints:**

- S3 Standard storage: $0.023/GB/month
- S3 Standard requests: $0.0004 per 1,000 PUT requests
- S3 Standard data transfer out: $0.09/GB
- CDN bandwidth: $0.01/GB (10Ã— cheaper than S3)
- Average photo: 2 MB (original), 200 KB (large), 50 KB (medium), 10 KB (thumbnail)

Design an object storage strategy that:

- Minimizes storage costs
- Minimizes bandwidth costs
- Handles upload scale
- Supports multiple photo sizes
- Meets performance requirements

### Solution

#### ğŸ§© Scenario

- **Photos:** 10 billion photos
- **Storage:** 20 PB (10B Ã— 2 MB)
- **Uploads:** 1M/day (peak 100k/hour)
- **Views:** 10B/day (peak 1M/second)
- **Cost Optimization:** Primary concern

**Calculations:**

- **Daily Bandwidth:** 10B views Ã— 200 KB (average) = 2 PB/day
- **Cost Without CDN:** 2 PB Ã— $0.09/GB = $180M/day
- **Cost With CDN (95% hit):** 100 TB Ã— $0.09/GB + 1.9 PB Ã— $0.01/GB = $9M + $19M = $28M/day
- **Savings:** $152M/day (84% reduction)

#### âœ… Step 1: Storage Architecture

**Choice: S3 with Lifecycle Policies**

**Bucket Structure:**

```
Bucket: photos-app
  â”œâ”€ originals/
  â”‚   â””â”€ {user_id}/{photo_id}.jpg
  â”œâ”€ large/
  â”‚   â””â”€ {user_id}/{photo_id}_large.jpg
  â”œâ”€ medium/
  â”‚   â””â”€ {user_id}/{photo_id}_medium.jpg
  â””â”€ thumbnails/
      â””â”€ {user_id}/{photo_id}_thumb.jpg
```

**Storage Classes:**

```
Recent photos (last 30 days):
  - Standard storage (frequent access)
  - All sizes cached

Old photos (30+ days):
  - Standard for thumbnails/medium (still accessed)
  - Infrequent Access for large/originals (less accessed)
  - Glacier for originals older than 1 year (rarely accessed)
```

#### âœ… Step 2: Photo Processing Pipeline

**Upload Flow:**

```
1. User uploads photo â†’ API Gateway
2. API Gateway â†’ S3 (original, multipart upload)
3. S3 Event â†’ Lambda (triggers on upload)
4. Lambda â†’ Image Processing Service
5. Image Processing â†’ Generates 3 sizes (large, medium, thumbnail)
6. Image Processing â†’ Uploads to S3 (3 objects)
7. Lambda â†’ Updates database (photo metadata)
```

**S3 Event Configuration:**

```
S3 Event: s3:ObjectCreated:*
Trigger: Lambda function
Lambda: Processes image, generates sizes
```

#### âœ… Step 3: CDN Integration

**Architecture:**

```
User â†’ CDN (CloudFront) â†’ S3 (if cache miss)
```

**Caching Strategy:**

```
Thumbnails/Medium:
  - Cache at CDN edge (TTL: 1 year)
  - High cache hit rate (98%+)
  - Rarely change

Large/Originals:
  - Cache at CDN edge (TTL: 30 days)
  - Moderate cache hit rate (85%+)
  - May be updated (user edits)

Overall Cache Hit Rate: 95%+
```

#### âœ… Step 4: Cost Optimization

**Storage Cost:**

```
10B photos Ã— 2 MB = 20 PB

Recent (30 days, 10%): 2 PB
  - Standard: 2 PB Ã— $0.023/GB = $46M/month

Old (30+ days, 90%): 18 PB
  - Thumbnails/Medium (Standard): 3.6 PB Ã— $0.023 = $82.8M/month
  - Large (Infrequent Access): 3.6 PB Ã— $0.0125 = $45M/month
  - Originals (Glacier, 1+ year): 10.8 PB Ã— $0.004 = $43.2M/month

Total Storage: $217M/month
```

**Bandwidth Cost:**

```
Daily Views: 10B Ã— 200 KB (average) = 2 PB/day

With CDN (95% hit):
  - CDN: 1.9 PB Ã— $0.01/GB = $19M/day
  - S3: 100 TB Ã— $0.09/GB = $9M/day
  - Total: $28M/day = $840M/month

Without CDN:
  - S3: 2 PB Ã— $0.09/GB = $180M/day = $5.4B/month
```

**Total Cost:**

```
Storage: $217M/month
Bandwidth: $840M/month
Requests: $0.4M/month (1M uploads/day Ã— $0.0004/1k)
Total: $1.057B/month

vs. Without optimization: $5.4B/month (bandwidth only)
Savings: $4.3B/month (80% reduction)
```

#### âœ… Step 5: Upload Optimization

**Multipart Upload:**

```
Large photos (>5 MB):
  - Use multipart upload
  - Chunks: 5 MB each
  - Parallel upload (10 parts at a time)
  - Resumable (retry failed parts)
```

**Upload Flow:**

```
1. Client â†’ Initiate multipart upload
2. Client â†’ Upload parts (parallel)
3. Client â†’ Complete multipart upload
4. S3 â†’ Combines parts â†’ Single object
```

#### âœ… Step 6: Access Patterns

**Read Patterns:**

```
Thumbnails: 80% of views (feed, grid view)
Medium: 15% of views (detail view)
Large: 4% of views (full-screen)
Original: 1% of views (download)
```

**Optimization:**

```
- Cache thumbnails/medium at CDN (high hit rate)
- Serve large/originals from S3 (lower demand)
- Use lifecycle policies (move old originals to Glacier)
```

#### âœ… Complete Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Users (Global)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚              â”‚
        â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CDN Edge     â”‚ â”‚ CDN Edgeâ”‚ â”‚ CDN Edge     â”‚
â”‚ (200+ edges) â”‚ â”‚         â”‚ â”‚              â”‚
â”‚              â”‚ â”‚         â”‚ â”‚              â”‚
â”‚ Cache:       â”‚ â”‚ Cache:  â”‚ â”‚ Cache:       â”‚
â”‚ - Thumbnails â”‚ â”‚ - Mediumâ”‚ â”‚ - Large      â”‚
â”‚ - Medium     â”‚ â”‚         â”‚ â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚              â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      S3 Buckets                   â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ originals/ (Standard/Glacier) â”‚ â”‚
    â”‚  â”‚ large/ (Standard/IA)          â”‚ â”‚
    â”‚  â”‚ medium/ (Standard)             â”‚ â”‚
    â”‚  â”‚ thumbnails/ (Standard)         â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      Image Processing (Lambda)     â”‚
    â”‚  - Generates sizes                 â”‚
    â”‚  - Uploads to S3                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Request Flow:**

```
1. User views photo â†’ CDN edge
2. CDN checks cache â†’ Hit (95% of time)
3. CDN serves photo â†’ <20ms latency

If cache miss:
1. CDN â†’ S3 (fetches photo)
2. S3 â†’ CDN (serves photo)
3. CDN caches photo
4. CDN â†’ User (serves photo)
5. Latency: <200ms (first request)
```

#### âš–ï¸ Trade-offs Summary

| Decision               | What We Gain                               | What We Sacrifice                   |
|------------------------|--------------------------------------------|-------------------------------------|
| **Lifecycle Policies** | 60% storage cost reduction                 | Retrieval delay for Glacier (hours) |
| **CDN Integration**    | 84% bandwidth cost reduction               | Cache invalidation complexity       |
| **Multiple Sizes**     | Bandwidth savings (serve appropriate size) | 4Ã— storage (4 objects per photo)    |
| **Multipart Upload**   | Reliable large file uploads                | More complex client logic           |

#### âœ… Final Summary

**Object Storage Strategy:**

- **Storage:** S3 with lifecycle policies (Standard â†’ IA â†’ Glacier)
- **CDN:** CloudFront in front of S3 (95% cache hit rate)
- **Processing:** Lambda generates multiple sizes on upload
- **Cost:** $1.057B/month (vs $5.4B/month without optimization, 80% savings)

**Performance:**

- **Upload:** Multipart upload for large photos (resumable)
- **View Latency:** <20ms (95% cache hit), <200ms (cache miss)
- **Throughput:** Handles 1M views/second (CDN scales automatically)

**Result:**

- âœ… Minimizes storage costs (lifecycle policies)
- âœ… Minimizes bandwidth costs (CDN, 84% reduction)
- âœ… Handles upload scale (multipart upload, Lambda processing)
- âœ… Supports multiple sizes (4 objects per photo)
- âœ… Meets performance requirements (<20ms for 95% of requests)

