# 2.0.1 Foundational Communication Protocols: TCP, UDP, and the Web Stack

## Intuitive Explanation

Protocols are the foundational rules for how computers exchange data. Think of them as the postal service:

- **TCP (The Certified Mail):** Reliable, ordered, and guaranteed delivery. It's slow because it constantly checks, "Did
  you get that package? Did you get the next one?" Used for data you absolutely can't lose (like bank transactions).
- **UDP (The Postcard):** Unreliable, fast, and no guarantees. You send it and forget it. If it gets lost, too bad. Used
  for real-time streams where losing a single packet is better than waiting (like live video or gaming).
- **HTTP (The Request Form):** The standard language of the web. It's built on TCP and uses a simple request/response
  model.

---

## In-Depth Analysis

### 1. TCP (Transmission Control Protocol)

$TCP$ is a connection-oriented protocol that provides reliable, ordered, and error-checked delivery of a stream of bytes
between applications running on hosts communicating over an IP network.

- **Reliability:** Achieved through sequence numbers and acknowledgments $(ACK)$.
- **Connection Setup:** Uses the **Three-Way Handshake** $(SYN, SYN-ACK, ACK)$ to establish a connection.
- **Flow Control & Congestion Control:** Manages the rate of data transmission to prevent overwhelming the receiver or
  the network.
- **Use Cases:** Web Browsing $(HTTP/S)$, Email $(SMTP)$, File Transfer $(FTP)$.

### 2. UDP (User Datagram Protocol)

$UDP$ is a connectionless protocol. It is fast because it foregoes the overhead of guaranteed delivery, flow control,
and error checking.

- **Speed Over Reliability:** Data is sent in independent packets (datagrams) without guaranteeing arrival or order.
- **Minimal Overhead:** Has a much smaller header than TCP.
- **Use Cases:** DNS queries, Video Streaming (where dropping a frame is better than stuttering), Real-time
  Gaming, $Voice over IP (VoIP)$.

### 3. HTTP/HTTPS (Hypertext Transfer Protocol Secure)

$HTTP$ is an application-layer protocol built primarily on TCP (usually port 80 or 443).

- **Statelessness:** Each request is independent. If a client needs persistent state (like a shopping cart), that state
  must be handled by the application layer (e.g., using cookies or tokens).
- **HTTPS:** HTTP wrapped with $TLS (Transport Layer Security)$ or $SSL$, providing encryption and authentication. This
  prevents man-in-the-middle attacks.

### 4. Specialized Protocols

| Protocol        | Underlying Tech | Use Case                               | Characteristics                                                                                                                     |
|-----------------|-----------------|----------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| WebSockets      | Built on TCP    | Real-time chat, live updates, gaming.  | Full-duplex, persistent connection. Low latency.                                                                                    |
| WebRTC          | Built on UDP    | Peer-to-peer video/audio conferencing. | Fast, direct communication between clients; ideal for high-bandwidth, low-latency streams.                                          |
| MPEG-DASH / HLS | Built on HTTP   | Video streaming (Netflix, YouTube).    | Dynamic streaming: video is broken into small chunks that can be requested at different quality levels based on network conditions. |

### Key Concepts / Tradeoffs

| Choice                         | Rationale                                                                                                                                                            | Trade-off / Scalability Issue                                                                                                                             |
|--------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| TCP over UDP                   | Choose TCP when data integrity is paramount (e.g., database writes, file uploads).                                                                                   | TCP has higher overhead (handshakes, ACKs) leading to higher latency and lower throughput capacity.                                                       |
| UDP over TCP                   | Choose UDP when speed is paramount and occasional packet loss is tolerable (e.g., real-time monitoring).                                                             | Requires the application layer to manually handle reliability, sequencing, and error checking if necessary. Data loss is guaranteed under network stress. |
| HTTP 1.1 vs. HTTP/2 vs. HTTP/3 | Modern apps use HTTP/2 (multiplexing over one connection) or HTTP/3 (which uses UDP for faster connection establishment and better performance over shaky networks). | Using older versions of HTTP can lead to Head-of-Line (HoL) blocking, hurting performance.                                                                |

---

## ‚úèÔ∏è Design Challenge

### Problem

You are designing a distributed telemetry system that needs to ingest 1 million sensor readings per second. These
readings are time-stamped, and losing a small percentage of data is acceptable, but low latency is critical. Should you
use TCP or UDP for the ingestion layer? Justify your choice, including the required application layer responsibility.

### Solution

#### üß© Scenario Summary

- Ingestion rate: 1 million sensor readings per second
- Data type: time-stamped telemetry
- Requirements:
    - Low latency is critical ‚úÖ
    - Small data loss is acceptable ‚úÖ
    - High throughput ‚úÖ

- Goal: Choose between TCP or UDP for ingestion layer.

#### ‚úÖ Choice: Use UDP for the Ingestion Layer

Justification

1. Low latency priority
    - UDP is connectionless ‚Üí no handshake or retransmission delay.
    - Data is immediately sent and processed.
    - Perfect for time-sensitive telemetry.
2. Data loss tolerance
    - Since losing a small percentage of sensor readings is acceptable, reliability guarantees of TCP are unnecessary
      overhead.
3. Scalability
    - With 1M readings/sec, maintaining 1M TCP connections would be prohibitively expensive (per-connection buffers,
      state, and ACKs).
    - UDP scales easily with many senders.
4. High throughput
    - No retransmission congestion control means more consistent data flow, especially under lossy network conditions.

#### ‚úÖ Final Summary

| Aspect                           | Choice                                                                              | Reason                                                |
|----------------------------------|-------------------------------------------------------------------------------------|-------------------------------------------------------|
| **Protocol**                     | **UDP**                                                                             | Minimal latency, low overhead, scalable for 1M/s rate |
| **Loss tolerance**               | Acceptable ‚Üí no need for TCP‚Äôs reliability                                          |                                                       |
| **Application responsibilities** | Add timestamps, sequence IDs, and idempotent processing to detect/recover from loss |                                                       |
| **Outcome**                      | High-throughput, low-latency telemetry ingestion with controlled data loss          |                                                       |